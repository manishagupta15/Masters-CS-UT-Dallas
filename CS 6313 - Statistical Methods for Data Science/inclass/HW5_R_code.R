################################################################
# R code for HW 5 Exercises from Chapter 9                     #
################################################################

########
#9.7(a)#
########
#> 37.7 + c(-1,1) * qnorm(1-(1-0.9)/2) * 9.2/sqrt(100)
#[1] 36.18673 39.21327
#> 

########
#9.8(a)#
########
#> 42 + c(-1,1) * qnorm(1-(1-0.95)/2) * 5/sqrt(64)
#[1] 40.77502 43.22498
#> 

########
#9.9(a)#
########
x <- c(30, 50, 70)
n <- length(x)
df <- n - 1
xmean <- mean(x)
xsd <- sd(x)

#> xmean + c(-1,1) * qt(1-(1-0.9)/2, df) * xsd/sqrt(n)
#[1] 16.28291 83.71709
#> 

#########
#9.10(a)#
#########
p.hat <- 24/200
n <- 200

#> p.hat + c(-1,1) * qnorm(1-(1-0.96)/2) * sqrt(p.hat*(1-p.hat)/n)
#[1] 0.07280844 0.16719156
#> 

#########
#9.12(a)#
#########
#> 0.62 + c(-1,1) * qnorm(1-(1-0.95)/2) * 0.2/sqrt(52)
#[1] 0.5656404 0.6743596
#> 

######
#9.17#
######
p1.hat <- 0.45
n <- 900

#> qnorm(1-(1-0.95)/2) * sqrt(p1.hat*(1-p1.hat)/n)
#[1] 0.03250233
#> 

p2.hat <- 0.35
m <- 900

#> qnorm(1-(1-0.95)/2) * sqrt(p2.hat*(1-p2.hat)/m)
#[1] 0.03116144
#> 

#> qnorm(1-(1-0.95)/2) * sqrt(p1.hat*(1-p1.hat)/n + p2.hat*(1-p2.hat)/m)
#[1] 0.04502707
#> 

#########
#9.18(a)#
#########
x <- c(56, 47, 49, 37, 38, 60, 50, 43, 43, 59, 50, 56, 54, 58)
y <- c(53, 21, 32, 49, 45, 38, 44, 33, 32, 43, 53, 46, 36, 48, 39, 35, 37, 36, 
	39, 45)
n <- length(x)
m <- length(y)
xmean <- mean(x)
ymean <- mean(y)
xvar <- var(x)
yvar <- var(y)
pooled.var <- ((n - 1) * xvar + (m - 1) * yvar)/(n + m - 2)

# > xmean - ymean + c(-1,1) * qt(1-(1-0.95)/2, df = n + m - 2) * 
#		sqrt(pooled.var*((1/n) + (1/m)))
# [1]  4.248889 15.351111
# > 

########################################################################

